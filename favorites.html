<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ - –ö–∞—Ñ–µ–¥—Ä–∞ –ø–æ–ª–∏—Ç–æ–ª–æ–≥–∏–∏ –ë–ì–£</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">
                üìö –ö–∞—Ñ–µ–¥—Ä–∞ –ø–æ–ª–∏—Ç–æ–ª–æ–≥–∏–∏
            </a>
            <ul class="nav-menu">
                <li><a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
                <li><a href="catalog.html">–ö–∞—Ç–∞–ª–æ–≥ –∫–Ω–∏–≥</a></li>
                <li><a href="favorites.html">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</a></li>
                <li><a href="contacts.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
                <li><a href="login.html" id="authLink">–í–æ–π—Ç–∏</a></li>
            </ul>
        </div>
    </nav>

    <!-- –°–µ–∫—Ü–∏—è –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ -->
    <section class="favorites-section">
        <div class="container">
            <div class="favorites-header">
                <div class="section-header">
                    <h2>–ú–æ–∏ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –∫–Ω–∏–≥–∏</h2>
                    <p>–í–∞—à–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã</p>
                </div>
                <button class="btn btn-outline" onclick="clearAllFavorites()">
                    üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ
                </button>
            </div>

            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="favorites-stats">
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-number" id="totalFavorites">0</span>
                        <span class="stat-label">–í—Å–µ–≥–æ –∫–Ω–∏–≥</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="readBooks">0</span>
                        <span class="stat-label">–ü—Ä–æ—á–∏—Ç–∞–Ω–æ</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="downloadedBooks">0</span>
                        <span class="stat-label">–°–∫–∞—á–∞–Ω–æ</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="recentAdded">0</span>
                        <span class="stat-label">–ó–∞ –º–µ—Å—è—Ü</span>
                    </div>
                </div>
            </div>

            <!-- –°–µ—Ç–∫–∞ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –∫–Ω–∏–≥ -->
            <div class="books-grid" id="favoritesContainer">
                <!-- –ò–∑–±—Ä–∞–Ω–Ω—ã–µ –∫–Ω–∏–≥–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
            </div>

            <!-- –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—É—Å—Ç–æ–≥–æ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ -->
            <div class="empty-state" id="emptyState" style="display: none;">
                <h3>–í –∏–∑–±—Ä–∞–Ω–Ω–æ–º –ø–æ–∫–∞ –Ω–µ—Ç –∫–Ω–∏–≥</h3>
                <p>–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∫–∞—Ç–∞–ª–æ–≥ –∏ –¥–æ–±–∞–≤—å—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–µ –≤–∞—Å –∫–Ω–∏–≥–∏</p>
                <a href="catalog.html" class="btn btn-primary" style="margin-top: 1rem;">
                    –ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥
                </a>
            </div>
        </div>
    </section>

    <!-- –§—É—Ç–µ—Ä -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>–ö–∞—Ñ–µ–¥—Ä–∞ –ø–æ–ª–∏—Ç–æ–ª–æ–≥–∏–∏</h3>
                    <p>–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π —Ñ–∞–∫—É–ª—å—Ç–µ—Ç<br>–ë–µ–ª–æ—Ä—É—Å—Å–∫–∏–π –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç</p>
                </div>
                <div class="footer-section">
                    <h3>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
                    <ul>
                        <li>üìû +375 (17) 209-55-55</li>
                        <li>üìß politology@bsu.by</li>
                        <li>üèõÔ∏è –≥. –ú–∏–Ω—Å–∫, —É–ª. –õ–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è, 8</li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>–†–µ—Å—É—Ä—Å—ã</h3>
                    <ul>
                        <li><a href="catalog.html">–ö–∞—Ç–∞–ª–æ–≥ –∫–Ω–∏–≥</a></li>
                        <li><a href="favorites.html">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</a></li>
                        <li><a href="contacts.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 –ö–∞—Ñ–µ–¥—Ä–∞ –ø–æ–ª–∏—Ç–æ–ª–æ–≥–∏–∏ –Æ—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–∞ –ë–ì–£. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
            </div>
        </div>
    </footer>

    <script src="scripts.js"></script>
    <script>
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –∫–Ω–∏–≥
        function loadFavorites() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            const favorites = JSON.parse(localStorage.getItem('favorites') || '{}');
            const userFavorites = favorites[currentUser?.email] || [];
            
            const container = document.getElementById('favoritesContainer');
            const emptyState = document.getElementById('emptyState');
            const totalFavorites = document.getElementById('totalFavorites');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            totalFavorites.textContent = userFavorites.length;
            
            if (userFavorites.length === 0) {
                container.style.display = 'none';
                emptyState.style.display = 'block';
                return;
            }
            
            container.style.display = 'grid';
            emptyState.style.display = 'none';
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º –∫–Ω–∏–≥–∏ –ø–æ –∏–∑–±—Ä–∞–Ω–Ω—ã–º ID
            const favoriteBooks = books.filter(book => userFavorites.includes(book.id));
            
            container.innerHTML = favoriteBooks.map(book => `
                <div class="book-card">
                    <div class="book-cover">${book.cover}</div>
                    <h4>${book.title}</h4>
                    <p class="book-author">${book.author}</p>
                    <div class="book-meta">
                        <span>${book.year} –≥.</span>
                        <span>${book.language}</span>
                    </div>
                    <div class="book-meta">
                        <span>${book.format}</span>
                        <span>‚≠ê ${book.rating}</span>
                    </div>
                    <div class="book-actions">
                        <button class="btn btn-success" onclick="downloadBook(${book.id})">
                            üì• –°–∫–∞—á–∞—Ç—å
                        </button>
                        <button class="btn btn-outline" onclick="removeFromFavorites(${book.id})">
                            ‚ùå –£–¥–∞–ª–∏—Ç—å
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
        function removeFromFavorites(bookId) {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            const favorites = JSON.parse(localStorage.getItem('favorites') || '{}');
            
            if (favorites[currentUser.email]) {
                favorites[currentUser.email] = favorites[currentUser.email].filter(id => id !== bookId);
                localStorage.setItem('favorites', JSON.stringify(favorites));
                showNotification('–ö–Ω–∏–≥–∞ —É–¥–∞–ª–µ–Ω–∞ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ', 'info');
                loadFavorites();
            }
        }

        // –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ–≥–æ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
        function clearAllFavorites() {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ?')) return;
            
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            const favorites = JSON.parse(localStorage.getItem('favorites') || '{}');
            
            favorites[currentUser.email] = [];
            localStorage.setItem('favorites', JSON.stringify(favorites));
            showNotification('–í—Å–µ –∫–Ω–∏–≥–∏ —É–¥–∞–ª–µ–Ω—ã –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ', 'info');
            loadFavorites();
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            if (!userSystem.isLoggedIn()) {
                window.location.href = 'login.html';
                return;
            }
            loadFavorites();
            updateNavigation();
        });
    </script>
</body>
</html>